\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{biblatex-btxlike}[2024/12/26 v1.0 A biblatex style mimicking BibTeX output]

% Load necessary packages or settings
\RequirePackage[
  backend=biber,
  style=alphabetic,
  isbn=false,
  doi=false,
  url=false,
  giveninits=true
]{biblatex}

% print url if no doi
\renewbibmacro*{doi+eprint+url}{%
  %\printfield{doi}%
  \newunit\newblock%
  \iftoggle{bbx:eprint}{%
    \usebibmacro{eprint}%
  }{}%
  \newunit\newblock%
  \iffieldundef{doi}{%
    \usebibmacro{url+urldate}}%
    {}%
}

\renewbibmacro{in:}{%
  \ifentrytype{article}{}{\printtext{\bibstring{in}\addspace}}}

\DeclareFieldFormat[article,inbook,incollection,inproceedings,patent,thesis,unpublished]{title}{#1}

\DeclareFieldFormat{edition}{#1 edition}

\AtEveryBibitem{%
  \ifentrytype{book}{
    \clearfield{pages}%
  }{}
}

\renewcommand{\subtitlepunct}{\itshape\addcolon\addspace}

\DeclareFieldFormat{url}{Available at \url{#1}}

\DeclareFieldFormat[article]{pages}{#1}

\renewcommand\bibpagespunct{%
  \ifentrytype{article}{\addcolon}{\addcomma\space}%
}

\RequirePackage{xpatch}
\xpatchbibdriver{incollection}
  {\newunit\newblock%
   \usebibmacro{chapter+pages}}
  {}{}{}

\xpatchbibdriver{incollection}
  {\usebibmacro{series+number}}
  {\usebibmacro{series+number}%
   \newunit\newblock%
   \usebibmacro{chapter+pages}}
  {}{}

\xpatchbibmacro{note+pages}
  {\printfield{pages}}
  {%
    \printfield{pages}%
    \setunit{\addcomma\addspace}%
    \usebibmacro{date}%
  }{}{}

\xpatchbibmacro{journal+issuetitle}{%
  \usebibmacro{journal}%
  \setunit*{\addspace}%
}{%
  \usebibmacro{journal}%
  \setunit*{\addcomma\addspace}%
}{}{}

\xpatchbibmacro{volume+number+eid}%
  {\setunit*{\adddot}%
   \printfield{number}%
   \setunit{\bibeidpunct}%
  }{%
   \printfield[parens]{number}%
   \setunit{\addcolon}%
  }{}{}

\renewbibmacro{issue+date}{}

% End of style definition
\endinput
